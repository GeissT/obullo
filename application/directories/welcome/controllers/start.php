<?php      

Class Start extends Controller {
    
    function __construct()
    {   
        parent::__construct();
        parent::__global();
        
        loader::database();
    }           
    
    public function index()
    {      
        $query = $this->db->query('SELECT * FROM articles');
        $num_rows = $query->row_count();
        
        $params = array(
            'mode'         => 'Sliding',
            'per_page'     => 2,
            'delta'        => 2,
            'httpMethod'   => 'GET',
            'urlVar'       => 'page',
            'append'       => TRUE,
            'query_string' => TRUE,
            'currentPage'  => $this->uri->segment(4),
            'base_url'     => '/obullo/index.php/welcome/start/index/',
            'total_items'  => $num_rows
        );
        
        /*
        $row = array();
        for($i=0; $i<=256; $i++)
        $row[$i] = $i.'__item';

        $params['itemData'] = $row;
        */
        
        $pager = pager::instance()->init($params);
         
        list($from, $to) = $pager->get_offset_by_page();
         
        echo 'from:'.$from.'<br />';
        echo 'to:'.$to.'<br />';
         
        $this->db->get('articles', $params['per_page'], $from - 1);
        $data = $this->db->fetch_all(assoc);
         
        // $data  = $pager->getPageData();
        $links = $pager->get_links();

        //$links is an ordered+associative array with 'back'/'pages'/'next'/'first'/'last'/'all' links.
        //NB: $links['all'] is the same as $pager->links;

        //echo links to other pages:
        echo $links['all'];

        
        // $selectBox = $pager->getPerPageSelectBox();
        // echo $selectBox;
        
        //Pager can also generate <link rel="first|prev|next|last"> tags
        // echo 'tags:'. $pager->linkTags.'<br /><br /><br />';

        //Show data for current page:
        print 'PAGED DATA: '.print_r($data).'<br /><br /><br />';

        //Results from methods:
        echo 'get_current_page()...: '.var_dump($pager->get_current_page()).'<br />';
        echo 'get_next_page()......: '.var_dump($pager->get_next_page()).'<br />';
        echo 'get_prev_page()..: '.var_dump($pager->get_prev_page()).'<br />';
        echo 'num_items()...........: '.var_dump($pager->num_items()).'<br />';
        echo 'num_pages()...........: '.var_dump($pager->num_pages()).'<br />';
        echo 'is_first_page()........: '.var_dump($pager->is_first_page()).'<br />';
        echo 'is_last_page().........: '.var_dump($pager->is_last_page()).'<br />';
        echo 'is_last_page_end().: '.var_dump($pager->is_last_page_end()).'<br />';
        echo '$pager->range........: '.var_dump($pager->range).'<br />';
        
        view_var('title', 'Welcome to Obullo Framework !');
        
        $data['var'] = 'This page generated by Obullo.';
        
        view_var('body', view('view_welcome', $data)); 
        view_app('view_base_layout'); 
    }
    
}

/* End of file start.php */
/* Location: .application/welcome/controllers/start.php */